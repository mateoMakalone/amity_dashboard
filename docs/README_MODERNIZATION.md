# üöÄ –ú–æ–¥–µ—Ä–Ω–∏–∑–∞—Ü–∏—è KPI Dashboard

## üìã –û–±–∑–æ—Ä –∏–∑–º–µ–Ω–µ–Ω–∏–π

–ú–æ–¥–µ—Ä–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π KPI Dashboard —Ç–µ–ø–µ—Ä—å –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç:

### ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏

1. **–ü—Ä—è–º—ã–µ –∑–∞–ø—Ä–æ—Å—ã –∫ Prometheus API**
   - –≠–Ω–¥–ø–æ–∏–Ω—Ç `/api/prometheus/query_range` –¥–ª—è –ø—Ä–æ–∫—Å–∏—Ä–æ–≤–∞–Ω–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤
   - –ü–æ–¥–¥–µ—Ä–∂–∫–∞ MOCK_MODE –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
   - –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ Prometheus

2. **–ö–æ–Ω—Ñ–∏–≥—É—Ä–∏—Ä—É–µ–º—ã–µ KPI-–º–µ—Ç—Ä–∏–∫–∏**
   - –ú–∞—Å—Å–∏–≤ `KPI_METRICS_CONFIG` –≤ `config.py`
   - –ü–æ–¥–¥–µ—Ä–∂–∫–∞ PromQL –∑–∞–ø—Ä–æ—Å–æ–≤
   - –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º—ã–µ –ø–æ—Ä–æ–≥–∏ (warning/critical)
   - –¶–≤–µ—Ç–æ–≤–∞—è —Å—Ö–µ–º–∞ –¥–ª—è –∫–∞–∂–¥–æ–π –º–µ—Ç—Ä–∏–∫–∏

3. **–ò–Ω—Ç–µ—Ä–≤–∞–ª—ã –≤—Ä–µ–º–µ–Ω–∏**
   - –ì–ª–æ–±–∞–ª—å–Ω—ã–π —Å–µ–ª–µ–∫—Ç–æ—Ä –∏–Ω—Ç–µ—Ä–≤–∞–ª–æ–≤ (15/30/45/60 –º–∏–Ω—É—Ç)
   - –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –≤—Å–µ—Ö –≥—Ä–∞—Ñ–∏–∫–æ–≤
   - –î–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö

4. **–ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–µ –≥—Ä–∞—Ñ–∏–∫–∏**
   - –õ–∏–Ω–µ–π–Ω—ã–µ –≥—Ä–∞—Ñ–∏–∫–∏ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ä—è–¥–æ–≤ (Plotly.js)
   - –ì–∏—Å—Ç–æ–≥—Ä–∞–º–º—ã —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –∑–Ω–∞—á–µ–Ω–∏–π
   - –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–π –¥–∏–∑–∞–π–Ω
   - Hover-–ø–æ–¥—Å–∫–∞–∑–∫–∏

5. **–≠–∫—Å–ø–æ—Ä—Ç –æ—Ç—á—ë—Ç–æ–≤**
   - –ö–Ω–æ–ø–∫–∞ "–≠–∫—Å–ø–æ—Ä—Ç –æ—Ç—á—ë—Ç–∞"
   - Standalone HTML —Å –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–º–∏ –≥—Ä–∞—Ñ–∏–∫–∞–º–∏
   - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–∫–∞—á–∏–≤–∞–Ω–∏–µ

6. **–°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π UI**
   - –°–µ—Ç–∫–∞ KPI-–∫–∞—Ä—Ç–æ—á–µ–∫
   - –°—Ç–∞—Ç—É—Å–Ω—ã–µ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã (OK/Warning/Critical)
   - –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–π –¥–∏–∑–∞–π–Ω
   - –†—É—Å—Å–∫–∏–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

### Backend (Flask)

```
app/
‚îú‚îÄ‚îÄ config.py              # KPI_METRICS_CONFIG, TIME_INTERVALS
‚îú‚îÄ‚îÄ routes.py              # /api/prometheus/query_range, /api/kpi/config
‚îú‚îÄ‚îÄ metrics.py             # –°—É—â–µ—Å—Ç–≤—É—é—â–∞—è –ª–æ–≥–∏–∫–∞ –º–µ—Ç—Ä–∏–∫
‚îî‚îÄ‚îÄ templates/
    ‚îî‚îÄ‚îÄ dashboard.html     # –ú–æ–¥–µ—Ä–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —à–∞–±–ª–æ–Ω
```

### Frontend (Vanilla JS + Plotly.js)

```
app/static/js/
‚îî‚îÄ‚îÄ dashboard.js           # –ü–æ–ª–Ω–æ—Å—Ç—å—é –ø–µ—Ä–µ–ø–∏—Å–∞–Ω–Ω—ã–π JS
```

## üîß –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### KPI-–º–µ—Ç—Ä–∏–∫–∏ (`config.py`)

```python
KPI_METRICS_CONFIG = [
    {
        "id": "api_response_time",
        "title": "–°—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è –æ—Ç–≤–µ—Ç–∞ API",
        "promql": 'avg(rate(jetty_server_requests_seconds_sum{outcome="SUCCESS",status="200"}[1m])) / avg(rate(jetty_server_requests_seconds_count{outcome="SUCCESS",status="200"}[1m]))',
        "unit": "—Å–µ–∫",
        "color": "#e74c3c",
        "format": "fixed3",
        "thresholds": {"warning": 0.5, "critical": 1.0}
    },
    # ... –¥—Ä—É–≥–∏–µ –º–µ—Ç—Ä–∏–∫–∏
]
```

### –ò–Ω—Ç–µ—Ä–≤–∞–ª—ã –≤—Ä–µ–º–µ–Ω–∏

```python
TIME_INTERVALS = [
    {"value": 15, "label": "15 –º–∏–Ω—É—Ç"},
    {"value": 30, "label": "30 –º–∏–Ω—É—Ç"}, 
    {"value": 45, "label": "45 –º–∏–Ω—É—Ç"},
    {"value": 60, "label": "1 —á–∞—Å"}
]
```

## üöÄ –ó–∞–ø—É—Å–∫ –∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### 1. –ó–∞–ø—É—Å–∫ —Å–µ—Ä–≤–µ—Ä–∞

```bash
python run.py
```

–°–µ—Ä–≤–µ—Ä –∑–∞–ø—É—Å—Ç–∏—Ç—Å—è –Ω–∞ `http://localhost:5000`

### 2. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ API

```bash
# –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è KPI
curl http://localhost:5000/api/kpi/config

# –ü—Ä–æ–∫—Å–∏ Prometheus
curl "http://localhost:5000/api/prometheus/query_range?query=system_cpu_usage&start=1640995200&end=1640998800&step=30"

# –ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞
curl http://localhost:5000/
```

### 3. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

```bash
python test_modernized_dashboard.py
```

## üìä –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å

### KPI-–∫–∞—Ä—Ç–æ—á–∫–∏

–ö–∞–∂–¥–∞—è KPI-–∫–∞—Ä—Ç–æ—á–∫–∞ —Å–æ–¥–µ—Ä–∂–∏—Ç:
- **–ó–∞–≥–æ–ª–æ–≤–æ–∫** —Å –Ω–∞–∑–≤–∞–Ω–∏–µ–º –º–µ—Ç—Ä–∏–∫–∏
- **–¢–µ–∫—É—â–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ** —Å –µ–¥–∏–Ω–∏—Ü–∞–º–∏ –∏–∑–º–µ—Ä–µ–Ω–∏—è
- **–¶–≤–µ—Ç–æ–≤–æ–π –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä** —Å—Ç–∞—Ç—É—Å–∞ (OK/Warning/Critical)
- **–õ–∏–Ω–µ–π–Ω—ã–π –≥—Ä–∞—Ñ–∏–∫** –≤—Ä–µ–º–µ–Ω–Ω–æ–≥–æ —Ä—è–¥–∞
- **–ì–∏—Å—Ç–æ–≥—Ä–∞–º–º–∞** —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –∑–Ω–∞—á–µ–Ω–∏–π
- **–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫** —Å –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ–º

### –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ

- **–°–µ–ª–µ–∫—Ç–æ—Ä –∏–Ω—Ç–µ—Ä–≤–∞–ª–∞**: –≥–ª–æ–±–∞–ª—å–Ω–æ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–Ω–æ–≥–æ –æ–∫–Ω–∞
- **–ê–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ**: –∫–∞–∂–¥—ã–µ 30 —Å–µ–∫—É–Ω–¥
- **–≠–∫—Å–ø–æ—Ä—Ç**: —Å–∫–∞—á–∏–≤–∞–Ω–∏–µ HTML-–æ—Ç—á—ë—Ç–∞

### –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

- –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –æ—à–∏–±–æ–∫ Prometheus –Ω–∞ –≥—Ä–∞—Ñ–∏–∫–∞—Ö
- Fallback –Ω–∞ –º–æ–∫–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ –≤ MOCK_MODE
- Graceful degradation –ø—Ä–∏ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ API

## üé® UI/UX

### –î–∏–∑–∞–π–Ω
- –°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π –º–∏–Ω–∏–º–∞–ª–∏—Å—Ç–∏—á–Ω—ã–π –¥–∏–∑–∞–π–Ω
- –ê–¥–∞–ø—Ç–∏–≤–Ω–∞—è —Å–µ—Ç–∫–∞ –∫–∞—Ä—Ç–æ—á–µ–∫
- –ö–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–∞—è —Ü–≤–µ—Ç–æ–≤–∞—è —Å—Ö–µ–º–∞
- –ò–Ω—Ç—É–∏—Ç–∏–≤–Ω—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è

### –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å
- Hover-—ç—Ñ—Ñ–µ–∫—Ç—ã –Ω–∞ –≥—Ä–∞—Ñ–∏–∫–∞—Ö
- –ê–Ω–∏–º–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø–µ—Ä–µ—Ö–æ–¥—ã
- Responsive layout
- –°—Ç–∞—Ç—É—Å–Ω—ã–µ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã

## üîÑ –ú–∏–≥—Ä–∞—Ü–∏—è

### –ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–º –∫–æ–¥–µ

1. **config.py**: –¥–æ–±–∞–≤–ª–µ–Ω—ã `KPI_METRICS_CONFIG`, `TIME_INTERVALS`, `PROMETHEUS_URL`
2. **routes.py**: –¥–æ–±–∞–≤–ª–µ–Ω—ã `/api/prometheus/query_range`, `/api/kpi/config`
3. **dashboard.html**: –ø–æ–ª–Ω–æ—Å—Ç—å—é –ø–µ—Ä–µ–ø–∏—Å–∞–Ω
4. **dashboard.js**: –ø–æ–ª–Ω–æ—Å—Ç—å—é –ø–µ—Ä–µ–ø–∏—Å–∞–Ω

### –û–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å

- –°—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã (`/data`, `/history`) —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã
- MOCK_MODE –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è
- –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –º–µ—Ç—Ä–∏–∫ –Ω–µ –∏–∑–º–µ–Ω–µ–Ω–∞

## üêõ –û—Ç–ª–∞–¥–∫–∞

### –õ–æ–≥–∏

```python
# –í–∫–ª—é—á–µ–Ω–∏–µ debug-–ª–æ–≥–æ–≤
print(f"[DEBUG] KPI config loaded: {len(kpiConfig)} metrics")
print(f"[DEBUG] Prometheus query: {query}")
```

### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ API
curl -v http://localhost:5000/api/kpi/config

# –ü—Ä–æ–≤–µ—Ä–∫–∞ Prometheus –ø—Ä–æ–∫—Å–∏
curl -v "http://localhost:5000/api/prometheus/query_range?query=test&start=1&end=2&step=1"
```

## üìà –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

### –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏

- –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ KPI
- –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã –∫ Prometheus
- –õ–µ–Ω–∏–≤–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –≥—Ä–∞—Ñ–∏–∫–æ–≤
- Debounced –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è

### –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

- –í—Ä–µ–º—è –æ—Ç–≤–µ—Ç–∞ API
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ Prometheus
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–∞–º—è—Ç–∏
- –û—à–∏–±–∫–∏ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö

## üîÆ –ë—É–¥—É—â–∏–µ —É–ª—É—á—à–µ–Ω–∏—è

### –ü–ª–∞–Ω–∏—Ä—É–µ–º—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏

1. **–§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ –ª–µ–π–±–ª–∞–º**
   - –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –º–µ—Ç—Ä–∏–∫ –ø–æ —Å–µ—Ä–≤–∏—Å–∞–º
   - –§–∏–ª—å—Ç—Ä—ã –ø–æ –ø–æ–¥–∞–º/namespace

2. **–ê–ª–µ—Ä—Ç—ã**
   - –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –ø—Ä–µ–≤—ã—à–µ–Ω–∏–∏ –ø–æ—Ä–æ–≥–æ–≤
   - Email/Slack –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è

3. **–î–∞—à–±–æ—Ä–¥—ã**
   - –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö –¥–∞—à–±–æ—Ä–¥–æ–≤
   - Drag-and-drop –Ω–∞—Å—Ç—Ä–æ–π–∫–∞

4. **–ê–Ω–∞–ª–∏—Ç–∏–∫–∞**
   - –¢—Ä–µ–Ω–¥—ã –∏ –∞–Ω–æ–º–∞–ª–∏–∏
   - –ü—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞–Ω–∏–µ

---

## ‚úÖ –°—Ç–∞—Ç—É—Å —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

- [x] Backend API (Prometheus –ø—Ä–æ–∫—Å–∏)
- [x] KPI –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
- [x] Frontend –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
- [x] –ò–Ω—Ç–µ—Ä–≤–∞–ª—ã –≤—Ä–µ–º–µ–Ω–∏
- [x] –ì—Ä–∞—Ñ–∏–∫–∏ (–ª–∏–Ω–∏—è + –≥–∏—Å—Ç–æ–≥—Ä–∞–º–º–∞)
- [x] –≠–∫—Å–ø–æ—Ä—Ç –æ—Ç—á—ë—Ç–æ–≤
- [x] –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
- [x] –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
- [x] –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

**–ú–æ–¥–µ—Ä–Ω–∏–∑–∞—Ü–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∞! üéâ** 